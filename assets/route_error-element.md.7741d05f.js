import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.6f0990a9.js";const u=JSON.parse('{"title":"errorElement","description":"","frontmatter":{},"headers":[],"relativePath":"route/error-element.md","filePath":"route/error-element.md","lastUpdated":1699184954000}'),p={name:"route/error-element.md"},o=l(`<h1 id="errorelement" tabindex="-1"><code>errorElement</code> <a class="header-anchor" href="#errorelement" aria-label="Permalink to &quot;\`errorElement\`&quot;">â€‹</a></h1><p>å½“ <a href="https://baimingxuan.github.io/react-router6-doc/route/loader" target="_blank" rel="noreferrer">loader</a>ã€<a href="https://baimingxuan.github.io/react-router6-doc/route/action" target="_blank" rel="noreferrer">action</a> æˆ–ç»„ä»¶æ¸²æŸ“ä¸­å‡ºç°å¼‚å¸¸æ—¶ï¼Œè·¯ç”±çš„æ­£å¸¸æ¸²æŸ“è·¯å¾„ ( <code>&lt;Route element&gt;</code> ) å°†è¢«æ¸²æŸ“ä¸ºé”™è¯¯è·¯å¾„ ( <code>&lt;Route errorElement&gt;</code> )ï¼Œé”™è¯¯ä¿¡æ¯å°†é€šè¿‡ <a href="https://baimingxuan.github.io/react-router6-doc/hooks/use-route-error" target="_blank" rel="noreferrer"><code>useRouteError</code></a>æ˜¾ç¤ºã€‚</p><blockquote><p>NOTE</p><p>å¦‚æœæ‚¨ä¸æƒ³æŒ‡å®š React å…ƒç´ ï¼ˆå³ <code>errorElement={&lt;MyErrorBoundary /&gt;}</code> ï¼‰ï¼Œæ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ª <code>ErrorBoundary</code> ç»„ä»¶ï¼ˆå³ <code>ErrorBoundary={MyErrorBoundary}</code> ï¼‰ï¼ŒReact è·¯ç”±å™¨å°†åœ¨å†…éƒ¨ä¸ºæ‚¨è°ƒç”¨ <code>createElement</code> ã€‚</p></blockquote><blockquote><p>IMPORTANT</p><p>æ­¤åŠŸèƒ½åªæœ‰åœ¨ä½¿ç”¨æ•°æ®è·¯ç”±æ—¶æ‰æœ‰æ•ˆï¼Œè¯·å‚é˜… <a href="https://baimingxuan.github.io/react-router6-doc/routers/picking-a-router" target="_blank" rel="noreferrer">&quot;é€‰æ‹©è·¯ç”±&quot;</a>ã€‚</p></blockquote><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">Route</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">path</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/invoices/:id&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// if an exception is thrown here</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">loader</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{loadInvoice}</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// here</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">action</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{updateInvoice}</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// or here</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">element</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{&lt;</span><span style="color:#79B8FF;">Invoice</span><span style="color:#E1E4E8;"> /&gt;}</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// this will render instead of \`element\`</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">errorElement</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{&lt;</span><span style="color:#79B8FF;">ErrorBoundary</span><span style="color:#E1E4E8;"> /&gt;}</span></span>
<span class="line"><span style="color:#E1E4E8;">/&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Invoice</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;Happy {path}&lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ErrorBoundary</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> error </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">useRouteError</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">(error);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// Uncaught ReferenceError: path is not defined</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;Dang!&lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">Route</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">path</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/invoices/:id&quot;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// if an exception is thrown here</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">loader</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{loadInvoice}</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// here</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">action</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{updateInvoice}</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// or here</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">element</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{&lt;</span><span style="color:#005CC5;">Invoice</span><span style="color:#24292E;"> /&gt;}</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// this will render instead of \`element\`</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">errorElement</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{&lt;</span><span style="color:#005CC5;">ErrorBoundary</span><span style="color:#24292E;"> /&gt;}</span></span>
<span class="line"><span style="color:#24292E;">/&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Invoice</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;Happy {path}&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ErrorBoundary</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> error </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useRouteError</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  console.</span><span style="color:#6F42C1;">error</span><span style="color:#24292E;">(error);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// Uncaught ReferenceError: path is not defined</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;Dang!&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="å†’æ³¡" tabindex="-1">å†’æ³¡ <a class="header-anchor" href="#å†’æ³¡" aria-label="Permalink to &quot;å†’æ³¡&quot;">â€‹</a></h2><p>å½“è·¯ç”±æ²¡æœ‰ <code>errorElement</code> æ—¶ï¼Œé”™è¯¯å°†é€šè¿‡çˆ¶è·¯ç”±å†’æ³¡ã€‚è¿™æ ·ï¼Œæ‚¨å°±å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°è¿›è¡Œç»†åŒ–æˆ–æ¦‚æ‹¬ã€‚</p><p>å°† <code>errorElement</code> æ”¾åœ¨è·¯ç”±æ ‘çš„é¡¶ç«¯ï¼Œå°±èƒ½åœ¨ä¸€ä¸ªåœ°æ–¹å¤„ç†åº”ç”¨ç¨‹åºä¸­çš„å‡ ä¹æ‰€æœ‰é”™è¯¯ã€‚æˆ–è€…ï¼Œå°†å®ƒä»¬æ”¾åœ¨æ‰€æœ‰è·¯ç”±ä¸Šï¼Œè®©åº”ç”¨ç¨‹åºä¸­æ²¡æœ‰é”™è¯¯çš„éƒ¨åˆ†ç»§ç»­æ­£å¸¸å‘ˆç°ã€‚è¿™å°±ä¸ºç”¨æˆ·æä¾›äº†æ›´å¤šä»é”™è¯¯ä¸­æ¢å¤çš„é€‰æ‹©ï¼Œè€Œä¸æ˜¯ç¡¬åˆ·æ–°å’ŒğŸ¤ã€‚</p><h3 id="é»˜è®¤é”™è¯¯å…ƒç´ " tabindex="-1">é»˜è®¤é”™è¯¯å…ƒç´  <a class="header-anchor" href="#é»˜è®¤é”™è¯¯å…ƒç´ " aria-label="Permalink to &quot;é»˜è®¤é”™è¯¯å…ƒç´ &quot;">â€‹</a></h3><blockquote><p>IMPORTANT</p><p>æˆ‘ä»¬å»ºè®®åœ¨å°†åº”ç”¨ç¨‹åºäº¤ä»˜åˆ°ç”Ÿäº§ç¯å¢ƒä¹‹å‰ï¼Œè‡³å°‘æä¾›ä¸€ä¸ªæ ¹çº§ <code>errorElement</code> ï¼Œå› ä¸ºé»˜è®¤ <code>errorElement</code> çš„ç”¨æˆ·ç•Œé¢éå¸¸ä¸‘é™‹ï¼Œä¸é€‚åˆæœ€ç»ˆç”¨æˆ·ä½¿ç”¨ã€‚</p></blockquote><p>å¦‚æœä¸åœ¨è·¯ç”±æ ‘ä¸­æä¾› <code>errorElement</code> æ¥å¤„ç†ç»™å®šçš„é”™è¯¯ï¼Œé”™è¯¯å°±ä¼šå†’å‡ºæ¥ï¼Œç”±é»˜è®¤çš„ <code>errorElement</code> æ¥å¤„ç†ï¼Œå¹¶æ‰“å°é”™è¯¯ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ªã€‚æœ‰äº›äººè´¨ç–‘ä¸ºä»€ä¹ˆå †æ ˆè·Ÿè¸ªä¼šæ˜¾ç¤ºåœ¨ç”Ÿäº§æ„å»ºä¸­ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæ‚¨ä¸å¸Œæœ›åœ¨ç”Ÿäº§ç½‘ç«™ä¸Šæ˜¾ç¤ºå †æ ˆè·Ÿè¸ªã€‚ä¸è¿‡ï¼Œè¿™æ›´é€‚ç”¨äºæœåŠ¡å™¨ç«¯é”™è¯¯ï¼ˆRemix ç¡®å®ä¼šä»æœåŠ¡å™¨ç«¯åŠ è½½å™¨/æ“ä½œå“åº”ä¸­å‰¥ç¦»å †æ ˆè·Ÿè¸ªï¼‰ã€‚åœ¨å®¢æˆ·ç«¯ <code>react-router-dom</code> åº”ç”¨ç¨‹åºä¸­ï¼Œä»£ç å·²ç»å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰¾åˆ°ï¼Œå› æ­¤ä»»ä½•éšè—éƒ½åªæ˜¯é€šè¿‡éšè”½æ¥ä¿è¯å®‰å…¨ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä»ç„¶å¸Œæœ›åœ¨æ§åˆ¶å°ä¸­æ˜¾ç¤ºé”™è¯¯ï¼Œå› æ­¤ä»ç”¨æˆ·ç•Œé¢æ˜¾ç¤ºä¸­åˆ é™¤é”™è¯¯ä»ç„¶ä¸èƒ½éšè—å †æ ˆè·Ÿè¸ªçš„ä»»ä½•ä¿¡æ¯ã€‚ä¸åœ¨ç”¨æˆ·ç•Œé¢ä¸­æ˜¾ç¤ºé”™è¯¯ï¼Œä¹Ÿä¸åœ¨æ§åˆ¶å°ä¸­è®°å½•é”™è¯¯ï¼Œè¿™å°±æ„å‘³ç€åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜æ ¹æœ¬æ— æ³•è·å¾—æœ‰å…³ç”Ÿäº§é”™è¯¯çš„ä»»ä½•ä¿¡æ¯ï¼Œè¿™æœ¬èº«å°±ä¼šå¸¦æ¥ä¸€ç³»åˆ—é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡å»ºè®®æ‚¨åœ¨å°†ç½‘ç«™éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¹‹å‰ï¼Œå§‹ç»ˆæ·»åŠ æ ¹çº§ <code>errorElement</code> ï¼</p><h2 id="æ‰‹åŠ¨æŠ›å‡º" tabindex="-1">æ‰‹åŠ¨æŠ›å‡º <a class="header-anchor" href="#æ‰‹åŠ¨æŠ›å‡º" aria-label="Permalink to &quot;æ‰‹åŠ¨æŠ›å‡º&quot;">â€‹</a></h2><p><code>errorElement</code> å¯å¤„ç†æ„å¤–é”™è¯¯ï¼Œä¹Ÿå¯ç”¨äºå¤„ç†é¢„æœŸå¼‚å¸¸ã€‚</p><p>ç‰¹åˆ«æ˜¯åœ¨<code>loader</code>å’Œ<code>action</code>ä¸­ï¼Œå½“æ‚¨å¤„ç†ä¸å—æ‚¨æ§åˆ¶çš„å¤–éƒ¨æ•°æ®æ—¶ï¼Œæ‚¨ä¸å¯èƒ½æ€»æ˜¯è®¡åˆ’æ•°æ®æ˜¯å¦å­˜åœ¨ã€æœåŠ¡æ˜¯å¦å¯ç”¨æˆ–ç”¨æˆ·æ˜¯å¦èƒ½è®¿é—®å®ƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ <code>throw</code> è‡ªå·±çš„å¼‚å¸¸ã€‚</p><p>è¿™æ˜¯ <a href="https://baimingxuan.github.io/react-router6-doc/route/loader" target="_blank" rel="noreferrer">loader</a> ä¸­çš„ä¸€ä¸ª &quot;æœªæ‰¾åˆ° &quot;æ¡ˆä¾‹ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">Route</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">path</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/properties/:id&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">element</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{&lt;</span><span style="color:#79B8FF;">PropertyForSale</span><span style="color:#E1E4E8;"> /&gt;}</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">errorElement</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{&lt;</span><span style="color:#79B8FF;">PropertyError</span><span style="color:#E1E4E8;"> /&gt;}</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">loader</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> ({ </span><span style="color:#FFAB70;">params</span><span style="color:#E1E4E8;"> }) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">res</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fetch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`/api/properties/\${</span><span style="color:#E1E4E8;">params</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">id</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (res.status </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">404</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Response</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Not Found&quot;</span><span style="color:#E1E4E8;">, { status: </span><span style="color:#79B8FF;">404</span><span style="color:#E1E4E8;"> });</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">home</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> res.</span><span style="color:#B392F0;">json</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">descriptionHtml</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">parseMarkdown</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">      data.descriptionMarkdown</span></span>
<span class="line"><span style="color:#E1E4E8;">    );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> { home, descriptionHtml };</span></span>
<span class="line"><span style="color:#E1E4E8;">  }}</span></span>
<span class="line"><span style="color:#E1E4E8;">/&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">Route</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">path</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/properties/:id&quot;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">element</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{&lt;</span><span style="color:#005CC5;">PropertyForSale</span><span style="color:#24292E;"> /&gt;}</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">errorElement</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{&lt;</span><span style="color:#005CC5;">PropertyError</span><span style="color:#24292E;"> /&gt;}</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">loader</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> ({ </span><span style="color:#E36209;">params</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">res</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fetch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">\`/api/properties/\${</span><span style="color:#24292E;">params</span><span style="color:#032F62;">.</span><span style="color:#24292E;">id</span><span style="color:#032F62;">}\`</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (res.status </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">404</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Response</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Not Found&quot;</span><span style="color:#24292E;">, { status: </span><span style="color:#005CC5;">404</span><span style="color:#24292E;"> });</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">home</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> res.</span><span style="color:#6F42C1;">json</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">descriptionHtml</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">parseMarkdown</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">      data.descriptionMarkdown</span></span>
<span class="line"><span style="color:#24292E;">    );</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> { home, descriptionHtml };</span></span>
<span class="line"><span style="color:#24292E;">  }}</span></span>
<span class="line"><span style="color:#24292E;">/&gt;</span></span></code></pre></div><p>ä¸€æ—¦çŸ¥é“æ— æ³•ç”¨åŠ è½½çš„æ•°æ®æ¸²æŸ“è·¯ç”±ï¼Œå°±å¯ä»¥æŠ›å‡ºä¸­æ–­è°ƒç”¨æ ˆã€‚å½“åŠ è½½å™¨ä¸­çš„å…¶ä»–å·¥ä½œï¼ˆå¦‚è§£æç”¨æˆ·çš„ markdown bioï¼‰ä¸å­˜åœ¨æ—¶ï¼Œä½ å°±ä¸ç”¨æ‹…å¿ƒäº†ã€‚åªéœ€æŠ›å‡ºå¹¶ç¦»å¼€å³å¯ã€‚</p><p>è¿™ä¹Ÿæ„å‘³ç€æ‚¨ä¸å¿…æ‹…å¿ƒè·¯ç”±ç»„ä»¶ä¸­ä¼šå‡ºç°å¤§é‡é”™è¯¯åˆ†æ”¯ä»£ç ï¼Œå¦‚æœæ‚¨åœ¨åŠ è½½å™¨æˆ–åŠ¨ä½œä¸­åŠ å…¥é”™è¯¯åˆ†æ”¯ä»£ç ï¼Œå®ƒç”šè‡³ä¸ä¼šå°è¯•æ¸²æŸ“ï¼Œè€Œæ˜¯ç”±æ‚¨çš„ <code>errorElement</code> æ¸²æŸ“ã€‚</p><p>æ‚¨å¯ä»¥ä»<code>loader</code>æˆ–<code>action</code>ä¸­æŠ›å‡ºä»»ä½•ä¸œè¥¿ï¼Œå°±åƒæ‚¨å¯ä»¥è¿”å›ä»»ä½•ä¸œè¥¿ä¸€æ ·ï¼šå“åº”ï¼ˆå¦‚ä¸Šä¸€ç¤ºä¾‹ï¼‰ã€é”™è¯¯æˆ–æ™®é€šå¯¹è±¡ã€‚</p><h2 id="æŠ›å‡ºå“åº”" tabindex="-1">æŠ›å‡ºå“åº” <a class="header-anchor" href="#æŠ›å‡ºå“åº”" aria-label="Permalink to &quot;æŠ›å‡ºå“åº”&quot;">â€‹</a></h2><p>é€šè¿‡ <a href="https://baimingxuan.github.io/react-router6-doc/hooks/use-route-error" target="_blank" rel="noreferrer"><code>useRouteError</code></a>å¦‚æœæŠ›å‡ºçš„æ˜¯å“åº” <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response" target="_blank" rel="noreferrer">Response</a>ï¼ŒReact Router ä¼šè‡ªåŠ¨è§£æå“åº”æ•°æ®ï¼Œç„¶åå°†å…¶è¿”å›ç»™æ‚¨çš„ç»„ä»¶ã€‚</p><p>æ­¤å¤–ï¼Œ<a href="https://baimingxuan.github.io/react-router6-doc/utils/is-route-error-response" target="_blank" rel="noreferrer"><code>isRouteErrorResponse</code></a> è¿˜å¯è®©æ‚¨åœ¨è¾¹ç•Œä¸­æ£€æŸ¥è¿™ç§ç‰¹å®šç±»å‹ã€‚é…åˆ<a href="https://baimingxuan.github.io/react-router6-doc/fetch/json" target="_blank" rel="noreferrer"><code>json</code></a>ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°æŠ›å‡ºå¸¦æœ‰æŸäº›æ•°æ®çš„å“åº”ï¼Œå¹¶åœ¨è¾¹ç•Œä¸­å‘ˆç°ä¸åŒçš„æƒ…å†µï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { json } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;react-router-dom&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">loader</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">stillWorksHere</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">userStillWorksHere</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">stillWorksHere) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">json</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">      {</span></span>
<span class="line"><span style="color:#E1E4E8;">        sorry: </span><span style="color:#9ECBFF;">&quot;You have been fired.&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        hrEmail: </span><span style="color:#9ECBFF;">&quot;hr@bigco.com&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      },</span></span>
<span class="line"><span style="color:#E1E4E8;">      { status: </span><span style="color:#79B8FF;">401</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"><span style="color:#E1E4E8;">    );</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ErrorBoundary</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">error</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">useRouteError</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#B392F0;">isRouteErrorResponse</span><span style="color:#E1E4E8;">(error) </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> error.status </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">401</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// the response json is automatically parsed to</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// \`error.data\`, you also have access to the status</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">      &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">h1</span><span style="color:#E1E4E8;">&gt;{error.status}&lt;/</span><span style="color:#85E89D;">h1</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">h2</span><span style="color:#E1E4E8;">&gt;{error.data.sorry}&lt;/</span><span style="color:#85E89D;">h2</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">p</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">          Go ahead and email {error.data.hrEmail} if you</span></span>
<span class="line"><span style="color:#E1E4E8;">          feel like this is a mistake.</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">p</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">      &lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    );</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// rethrow to let the parent error boundary handle it</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// when it&#39;s not a special case for this route</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> error;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { json } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;react-router-dom&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">loader</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">stillWorksHere</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">userStillWorksHere</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">stillWorksHere) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">json</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">      {</span></span>
<span class="line"><span style="color:#24292E;">        sorry: </span><span style="color:#032F62;">&quot;You have been fired.&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        hrEmail: </span><span style="color:#032F62;">&quot;hr@bigco.com&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      { status: </span><span style="color:#005CC5;">401</span><span style="color:#24292E;"> }</span></span>
<span class="line"><span style="color:#24292E;">    );</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ErrorBoundary</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">error</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useRouteError</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#6F42C1;">isRouteErrorResponse</span><span style="color:#24292E;">(error) </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> error.status </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">401</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// the response json is automatically parsed to</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// \`error.data\`, you also have access to the status</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">      &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;{error.status}&lt;/</span><span style="color:#22863A;">h1</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">h2</span><span style="color:#24292E;">&gt;{error.data.sorry}&lt;/</span><span style="color:#22863A;">h2</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">p</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">          Go ahead and email {error.data.hrEmail} if you</span></span>
<span class="line"><span style="color:#24292E;">          feel like this is a mistake.</span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">p</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">      &lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    );</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// rethrow to let the parent error boundary handle it</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// when it&#39;s not a special case for this route</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> error;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>è¿™æ ·å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªé€šç”¨çš„é”™è¯¯è¾¹ç•Œï¼Œé€šå¸¸åœ¨æ ¹è·¯ç”±ä¸Šï¼Œå¯ä»¥å¤„ç†å¾ˆå¤šæƒ…å†µï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RootBoundary</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">error</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">useRouteError</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#B392F0;">isRouteErrorResponse</span><span style="color:#E1E4E8;">(error)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (error.status </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">404</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;This page doesn&#39;t exist!&lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (error.status </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">401</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;You aren&#39;t authorized to see this&lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (error.status </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">503</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;Looks like our API is down&lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (error.status </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">418</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;ğŸ«–&lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;Something went wrong&lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RootBoundary</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">error</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">useRouteError</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#6F42C1;">isRouteErrorResponse</span><span style="color:#24292E;">(error)) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (error.status </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">404</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;This page doesn&#39;t exist!&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (error.status </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">401</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;You aren&#39;t authorized to see this&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (error.status </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">503</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;Looks like our API is down&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (error.status </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">418</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;ğŸ«–&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;Something went wrong&lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="æŠ½è±¡" tabindex="-1">æŠ½è±¡ <a class="header-anchor" href="#æŠ½è±¡" aria-label="Permalink to &quot;æŠ½è±¡&quot;">â€‹</a></h2><p>å½“çŸ¥é“æ— æ³•ç»§ç»­æ•°æ®åŠ è½½æ—¶ï¼Œå°±ä¼šæŠ›å‡ºè¿™ç§æ¨¡å¼ï¼Œè¿™ä½¿å¾—æ­£ç¡®å¤„ç†ç‰¹æ®Šæƒ…å†µå˜å¾—éå¸¸ç®€å•ã€‚</p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œè·å–ç”¨æˆ·æˆæƒè¯·æ±‚çš„ç½‘ç»œä»¤ç‰Œçš„å‡½æ•°æ˜¯è¿™æ ·çš„:</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getUserToken</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">token</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getTokenFromWebWorker</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">token) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Response</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">, { status: </span><span style="color:#79B8FF;">401</span><span style="color:#E1E4E8;"> });</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> token;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getUserToken</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">token</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getTokenFromWebWorker</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">token) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Response</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">, { status: </span><span style="color:#005CC5;">401</span><span style="color:#24292E;"> });</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> token;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>æ— è®ºå“ªä¸ªåŠ è½½å™¨æˆ–æ“ä½œä½¿ç”¨äº†è¯¥å‡½æ•°ï¼Œå®ƒéƒ½ä¼šåœæ­¢æ‰§è¡Œå½“å‰è°ƒç”¨æ ˆä¸­çš„ä»£ç ï¼Œå¹¶å°†åº”ç”¨ç¨‹åºå‘é€åˆ°é”™è¯¯è·¯å¾„ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªè·å–é¡¹ç›®çš„å‡½æ•°ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fetchProject</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">id</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">token</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getUserToken</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">response</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fetch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`/projects/\${</span><span style="color:#E1E4E8;">id</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">, {</span></span>
<span class="line"><span style="color:#E1E4E8;">    headers: { Authorization: </span><span style="color:#9ECBFF;">\`Bearer \${</span><span style="color:#E1E4E8;">token</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (response.status </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">404</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Response</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Not Found&quot;</span><span style="color:#E1E4E8;">, { status: </span><span style="color:#79B8FF;">404</span><span style="color:#E1E4E8;"> });</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// the fetch failed</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">response.ok) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Could not fetch project&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fetchProject</span><span style="color:#24292E;">(</span><span style="color:#E36209;">id</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">token</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getUserToken</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">response</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fetch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">\`/projects/\${</span><span style="color:#24292E;">id</span><span style="color:#032F62;">}\`</span><span style="color:#24292E;">, {</span></span>
<span class="line"><span style="color:#24292E;">    headers: { Authorization: </span><span style="color:#032F62;">\`Bearer \${</span><span style="color:#24292E;">token</span><span style="color:#032F62;">}\`</span><span style="color:#24292E;"> },</span></span>
<span class="line"><span style="color:#24292E;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (response.status </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">404</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Response</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Not Found&quot;</span><span style="color:#24292E;">, { status: </span><span style="color:#005CC5;">404</span><span style="color:#24292E;"> });</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// the fetch failed</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">response.ok) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Error</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Could not fetch project&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>ç”±äºæœ‰äº† <code>getUserToken</code> ï¼Œè¿™æ®µä»£ç å¯ä»¥å‡å®šè·å¾—äº†ä¸€ä¸ªæ ‡è®°ã€‚å¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šæ˜¾ç¤ºé”™è¯¯è·¯å¾„ã€‚ç„¶åï¼Œå¦‚æœé¡¹ç›®ä¸å­˜åœ¨ï¼Œæ— è®ºå“ªä¸ªåŠ è½½å™¨è°ƒç”¨æ­¤å‡½æ•°ï¼Œéƒ½ä¼šå‘ <code>errorElement</code> å‘é€ 404ã€‚æœ€åï¼Œå¦‚æœè·å–å®Œå…¨å¤±è´¥ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ã€‚</p><p>å½“ä½ æ„è¯†åˆ° &quot;æˆ‘æ²¡æœ‰æˆ‘éœ€è¦çš„ä¸œè¥¿ &quot;æ—¶ï¼Œä½ å¯ä»¥ç›´æ¥ <code>throw</code> ï¼Œå› ä¸ºä½ çŸ¥é“ä½ ä»ç„¶åœ¨ä¸ºæœ€ç»ˆç”¨æˆ·æä¾›æœ‰ç”¨çš„ä¸œè¥¿ã€‚</p><p>è®©æˆ‘ä»¬æŠŠå®ƒç»„åˆæˆä¸€æ¡è·¯ç”±ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">Route</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">path</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">element</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{&lt;</span><span style="color:#79B8FF;">Root</span><span style="color:#E1E4E8;"> /&gt;}</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">errorElement</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{&lt;</span><span style="color:#79B8FF;">RootBoundary</span><span style="color:#E1E4E8;"> /&gt;}</span></span>
<span class="line"><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#79B8FF;">Route</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">path</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;projects/:projectId&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">loader</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{({ </span><span style="color:#FFAB70;">params</span><span style="color:#E1E4E8;"> }) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fetchProject</span><span style="color:#E1E4E8;">(params.projectId)}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">element</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{&lt;</span><span style="color:#79B8FF;">Project</span><span style="color:#E1E4E8;"> /&gt;}</span></span>
<span class="line"><span style="color:#E1E4E8;">  /&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#79B8FF;">Route</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">Route</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">path</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/&quot;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">element</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{&lt;</span><span style="color:#005CC5;">Root</span><span style="color:#24292E;"> /&gt;}</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">errorElement</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{&lt;</span><span style="color:#005CC5;">RootBoundary</span><span style="color:#24292E;"> /&gt;}</span></span>
<span class="line"><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#005CC5;">Route</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">path</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;projects/:projectId&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">loader</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{({ </span><span style="color:#E36209;">params</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fetchProject</span><span style="color:#24292E;">(params.projectId)}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">element</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{&lt;</span><span style="color:#005CC5;">Project</span><span style="color:#24292E;"> /&gt;}</span></span>
<span class="line"><span style="color:#24292E;">  /&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#005CC5;">Route</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>é¡¹ç›®è·¯å¾„æ ¹æœ¬ä¸ç”¨è€ƒè™‘é”™è¯¯ã€‚åŠ è½½å™¨å®ç”¨ç¨‹åºï¼ˆå¦‚ <code>fetchProject</code> å’Œ <code>getUserToken</code> ï¼‰ä¼šåœ¨å‡ºç°é—®é¢˜æ—¶æŠ›å‡ºï¼Œè€Œ <code>RootBoundary</code> ä¼šå¤„ç†æ‰€æœ‰æƒ…å†µï¼Œå› æ­¤é¡¹ç›®è·¯å¾„åªéœ€ä¸“æ³¨äºæˆåŠŸä¹‹è·¯ã€‚</p>`,37),e=[o];function t(r,c,E,y,i,d){return n(),a("div",null,e)}const h=s(p,[["render",t]]);export{u as __pageData,h as default};
