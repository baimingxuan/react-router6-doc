(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{316:function(t,a,s){"use strict";s.r(a);var n=s(13),r=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"usenavigation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usenavigation"}},[t._v("#")]),t._v(" "),a("code",[t._v("useNavigation")])]),t._v(" "),a("p",[t._v("这个钩子告诉您关于页面导航的一切，以构建挂起导航指示器和在数据变化时进行乐观 UI。例如：")]),t._v(" "),a("ul",[a("li",[t._v("全局加载指示器")]),t._v(" "),a("li",[t._v("在发生突变时禁用表单")]),t._v(" "),a("li",[t._v("在提交按钮上添加忙碌指示器")]),t._v(" "),a("li",[t._v("在服务器上创建新记录时乐观地显示新记录")]),t._v(" "),a("li",[t._v("在更新记录时乐观地显示记录的新状态")])]),t._v(" "),a("blockquote",[a("p",[t._v("仅当使用数据路由器时，此功能才有效，请参阅"),a("a",{attrs:{href:"https://reactrouter.com/en/main/routers/picking-a-router",target:"_blank",rel:"noopener noreferrer"}},[t._v("选择路由"),a("OutboundLink")],1),t._v("。")])]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useNavigation "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"react-router-dom"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SomeComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" navigation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useNavigation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formAction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formMethod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"navigation-state"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#navigation-state"}},[t._v("#")]),t._v(" "),a("code",[t._v("navigation.state")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("idle")]),t._v(" - 没有待处理的导航。")]),t._v(" "),a("li",[a("strong",[t._v("submitting")]),t._v("- 由于使用POST、PUT、PATCH或DELETE提交表单而调用路由操作")]),t._v(" "),a("li",[a("strong",[t._v("loading")]),t._v(" - 下一个路由的加载器正在调用以呈现下一页")])]),t._v(" "),a("p",[t._v("正常导航和GET表单提交通过这些状态转换：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("idle → loading → idle\n")])])]),a("p",[t._v("使用POST、PUT、PATCH或DELETE的表单提交通过这些状态转换：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("idle → submitting → loading → idle\n")])])]),a("p",[t._v("这是一个简单的提交按钮，当导航状态正在更改时更改其文本：")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SubmitButton")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" navigation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useNavigation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"submitting"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Saving..."')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Saved!"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Go"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("submit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("虽然 "),a("code",[t._v("navigation.state")]),t._v(" 提供了活动导航的高级状态，但您可以通过将其与其他 "),a("code",[t._v("navigation")]),t._v(" 方面相结合来推断更细粒度的信息：")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Is this just a normal load?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" isNormalLoad "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Are we reloading after an action?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" isReloading "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formAction "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pathname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Are we redirecting after an action?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" isRedirecting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formAction "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pathname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"navigation-formdata"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#navigation-formdata"}},[t._v("#")]),t._v(" "),a("code",[t._v("navigation.formData")])]),t._v(" "),a("p",[t._v("从 "),a("code",[t._v("<Form>")]),t._v(" 或 "),a("code",[t._v("useSubmit")]),t._v(" 开始的任何POST、PUT、PATCH或DELETE导航都将附加到您的表单提交数据。这主要用于使用 "),a("code",[t._v("submission.formData")]),t._v(" "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/FormData",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("FormData")]),a("OutboundLink")],1),t._v("对象构建“乐观UI”。")]),t._v(" "),a("p",[t._v("在GET表单提交的情况下， "),a("code",[t._v("formData")]),t._v(" 将为空，并且数据将反映在 "),a("code",[t._v("navigation.location.search")]),t._v(" 中。")]),t._v(" "),a("h2",{attrs:{id:"navigation-location"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#navigation-location"}},[t._v("#")]),t._v(" "),a("code",[t._v("navigation.location")])]),t._v(" "),a("p",[t._v("这告诉您下一个"),a("a",{attrs:{href:"https://reactrouter.com/en/main/utils/location",target:"_blank",rel:"noopener noreferrer"}},[t._v("位置"),a("OutboundLink")],1),t._v("将是什么。")]),t._v(" "),a("p",[t._v("请注意，如果表单正在提交到链接指向的URL，则此链接不会显示为“待定”，因为我们仅对“加载”状态执行此操作。表单将包含“提交”状态下的待定UI，一旦操作完成，链接将变为待定状态。")])])}),[],!1,null,null,null);a.default=r.exports}}]);