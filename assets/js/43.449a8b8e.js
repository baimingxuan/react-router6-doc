(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{328:function(t,a,s){"use strict";s.r(a);var n=s(13),r=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"usenavigation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usenavigation"}},[t._v("#")]),t._v(" "),a("code",[t._v("useNavigation")])]),t._v(" "),a("p",[t._v("这个钩子告诉你关于页面导航你需要知道的一切，以构建挂起的导航指示器和数据突变的乐观 UI。像：")]),t._v(" "),a("ul",[a("li",[t._v("全局加载指标")]),t._v(" "),a("li",[t._v("发生突变时禁用表单")]),t._v(" "),a("li",[t._v("添加忙指示器以提交按钮")]),t._v(" "),a("li",[t._v("在服务器上创建时乐观地显示新记录")]),t._v(" "),a("li",[t._v("在记录更新时乐观地显示记录的新状态")])]),t._v(" "),a("p",[t._v("此功能仅在使用数据路由器时有效，请参阅"),a("a",{attrs:{href:"https://reactrouter.com/en/main/routers/picking-a-router",target:"_blank",rel:"noopener noreferrer"}},[t._v("选择路由器"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" useNavigation "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"react-router-dom"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SomeComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" navigation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useNavigation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formAction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formMethod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"navigation-state"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#navigation-state"}},[t._v("#")]),t._v(" "),a("code",[t._v("navigation.state")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("idle")]),t._v(" - 没有导航挂起。")]),t._v(" "),a("li",[a("strong",[t._v("提交")]),t._v("- 由于使用 POST、PUT、PATCH 或 DELETE 提交表单，正在调用路由操作")]),t._v(" "),a("li",[a("strong",[t._v("loading")]),t._v(" - 正在调用下一个路由的加载器以呈现下一个页面")])]),t._v(" "),a("p",[t._v("正常导航和 GET 表单提交通过这些状态转换：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("idle → loading → idle\n")])])]),a("p",[t._v("通过这些状态转换带有 POST、PUT、PATCH 或 DELETE 的表单提交：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("idle → submitting → loading → idle\n")])])]),a("p",[t._v("这是一个简单的提交按钮，当导航状态发生变化时，它会更改其文本：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SubmitButton")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" navigation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("useNavigation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n    navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"submitting"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Saving..."')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Saved!"')]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Go"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"submit"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("在"),a("code",[t._v("navigation.state")]),t._v("提供活动导航的高级状态的同时，您可以通过将其与其他"),a("code",[t._v("navigation")]),t._v("方面相结合来推断出更细粒度的信息：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Is this just a normal load?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" isNormalLoad "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Are we reloading after an action?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" isReloading "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formAction "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pathname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Are we redirecting after an action?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" isRedirecting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loading"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n  navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("formAction "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" navigation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pathname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"navigation-formdata"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#navigation-formdata"}},[t._v("#")]),t._v(" "),a("code",[t._v("navigation.formData")])]),t._v(" "),a("p",[t._v("任何从 a 开始的 POST、PUT、PATCH 或 DELETE 导航"),a("code",[t._v("<Form>")]),t._v("将"),a("code",[t._v("useSubmit")]),t._v("附加表单的提交数据。这主要用于使用"),a("code",[t._v("submission.formData")]),t._v(" "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/FormData",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("FormData")]),a("OutboundLink")],1),t._v("对象构建“乐观 UI”。")]),t._v(" "),a("p",[t._v("在 GET 表单提交的情况下，"),a("code",[t._v("formData")]),t._v("将为空，数据将反映在"),a("code",[t._v("navigation.location.search")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"navigation-location"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#navigation-location"}},[t._v("#")]),t._v(" "),a("code",[t._v("navigation.location")])]),t._v(" "),a("p",[t._v("这会告诉您下一个"),a("a",{attrs:{href:"https://reactrouter.com/en/main/utils/location",target:"_blank",rel:"noopener noreferrer"}},[t._v("位置"),a("OutboundLink")],1),t._v("是什么。")]),t._v(" "),a("p",[t._v("请注意，如果表单正在提交到链接指向的 URL，则此链接不会显示为“待处理”，因为我们只在“加载”状态下这样做。当状态为“正在提交”时，表单将包含待处理的 UI，一旦操作完成，链接将变为待处理状态。")])])}),[],!1,null,null,null);a.default=r.exports}}]);